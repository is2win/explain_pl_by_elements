# Explain PL by Elements

## Описание проекта
Этот проект реализует методологию распределения изменения стоимости деривативного контракта по компонентам

## Шаги расчёта spot_delta
1. **Вычисление общего изменения PV**: ΔPV = PV_сегодня - PV_вчера. Это полное изменение стоимости контракта за день.

2. **Сбор изменений спот-цен**: Для каждого актива i: ΔS_i = S_сегодня_i - S_вчера_i.

3. **Сумма абсолютных изменений**: Sum = ∑ |ΔS_i| по всем активам.

4. **Оценка delta_i для каждого актива**: delta_i ≈ (ΔPV × |ΔS_i| / Sum) / ΔS_i. Это распределяет вклад пропорционально "весу" движения каждого актива.

5. **Вклад spot_delta для актива**: contribution_i = delta_i × ΔS_i.

6. **Суммирование**: Общая spot_delta-компонента — сумма contribution_i по всем активам (равна ΔPV).

Это даёт линейную аппроксимацию изменения PV за счёт спот-цен.

## Формат ввода данных
Ввод — словарь (в Python) или JSON-объект:

```json
{
  "PV_yesterday": <float>,  // PV вчера (обязательно)
  "PV_today": <float>,      // PV сегодня (обязательно)
  "spots": {                // Словарь спот-цен (динамический)
    "<asset_name>": {
      "yesterday": <float>,
      "today": <float>
    }
    // ... дополнительные активы
  }
}
```

## Пример использования
В файле `spot_delta.py` есть функция `compute_spot_delta(input_data)` и пример:

```python
example_input = {
    "PV_yesterday": 1000.0,
    "PV_today": 1050.0,
    "spots": {
        "Sber": {"yesterday": 200.0, "today": 205.0},
        "VTB": {"yesterday": 150.0, "today": 148.0},
        "Gazprom": {"yesterday": 300.0, "today": 310.0}
    }
}
result = compute_spot_delta(example_input)
print(result)  # Пример: {'Sber': 14.705882352941176, 'VTB': -5.88235294117647, 'Gazprom': 41.1764705882353}
```

Сумма значений = 50.0 (ΔPV).

# explain_pl_by_elements
